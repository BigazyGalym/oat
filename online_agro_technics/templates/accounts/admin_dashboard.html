{% extends 'base.html' %}
{% load static %}
{% block title %}Админ панель{% endblock %}
{% block content %}
{% if request.user.profile.is_admin %}
<div class="container mx-auto p-6 bg-white rounded-xl shadow-2xl animate-fade-in">
    <h1 class="text-3xl font-bold text-green-700 mb-6 animate-slide-in">Админ панель</h1>
    
    <!-- Заказдар бөлімі -->
    <h2 class="text-2xl font-bold text-green-700 mb-4">Заказы</h2>
    <ul class="space-y-3">
        {% for order in orders %}
            <li class="p-4 bg-gray-50 rounded-lg hover:bg-green-50 transition duration-300 transform hover:-translate-y-1">
                Заказ #{{ order.id }} - Статус: <span class="font-semibold text-green-600">{{ order.get_status_display }}</span>
                (Клиент: {{ order.customer_id.username }}, Работник: {{ order.worker_id.username|default:"Не назначен" }})
            </li>
        {% empty %}
            <li class="p-4 bg-gray-50 rounded-lg text-gray-500">Заказов нет</li>
        {% endfor %}
    </ul>

    <!-- Техникалық қолдау бөлімі -->
    <h2 class="text-2xl font-bold text-green-700 mt-8 mb-4 animate-slide-in">Техническая поддержка</h2>
    <div class="overflow-x-auto">
        <table class="min-w-full bg-white shadow-md rounded-lg">
            <thead class="bg-gray-200">
                <tr>
                    <th class="px-4 py-2">ID</th>
                    <th class="px-4 py-2">Тема</th>
                    <th class="px-4 py-2">Статус</th>
                    <th class="px-4 py-2">Приоритет</th>
                    <th class="px-4 py-2">Клиент</th>
                    <th class="px-4 py-2">Дата создания</th>
                    <th class="px-4 py-2">Действия</th>
                </tr>
            </thead>
            <tbody>
                {% for ticket in tickets %}
                    <tr class="border-b">
                        <td class="px-4 py-2">{{ ticket.id }}</td>
                        <td class="px-4 py-2">{{ ticket.title }}</td>
                        <td class="px-4 py-2">{{ ticket.get_status_display }}</td>
                        <td class="px-4 py-2">{{ ticket.get_priority_display }}</td>
                        <td class="px-4 py-2">{{ ticket.user.username }}</td>
                        <td class="px-4 py-2">{{ ticket.created_at|date:"Y-m-d H:i" }}</td>
                        <td class="px-4 py-2">
                            <a href="{% url 'helpdesk:ticket_detail' ticket.id %}" class="text-blue-600 hover:underline">Просмотреть</a>
                        </td>
                    </tr>
                {% empty %}
                    <p class="text-gray-600">Тикетов нет.</p>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% else %}
<div class="container mx-auto p-6">
    <p class="text-red-600 text-xl font-bold">У вас нет доступа к админ-панели.</p>
</div>
{% endif %}
{% endblock %}